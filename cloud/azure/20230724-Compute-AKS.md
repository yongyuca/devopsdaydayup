# AKS (AZure Kubernetes Service)
上篇介绍了VM，在“古代”，当你的应用只有一个包(e.g. WAR包，JAR包)的时候，你可以直接把这个包部署到这台VM上就好，然后把VM连到互联网里，用户就能直接访问你的应用了。但是在如今这个“**微服务**”的时代，用VM来部署微服务几乎是不可能的事了，一般我们都会用一些微服务部署平台软件，比如K8s，来部署微服务。今天我们来介绍的AKS，就是**Azure平台自己包装过的Kubernetes服务**。</br>

微服务说白了就是把你的应用拆分成一个一个模块，然后部署到不同的服务器上，服务和服务之间使用API相互通信。微服务充分利用了操作系统里的**Container容器**的技术。所谓的容器，就是在一个操作系统里，通过技术手段（**Namespace+Cgroup+Chroot**)，把某个进程和系统里的其他进程隔离开来，让这个进程误以为自己是这个操作系统里的唯一进程，从而来使得部署在这个特殊进程里的应用之间逻辑隔离开来，互相不打扰。这个有点类似VM的一些逻辑，它也是在同一台物理机上隔离出了不同的操作系统环境，只是容器Container比起VM更轻量一些罢了。理解了容器，那理解像K8s这样的容器管理平台(**Container Orchestration**)就能更好的理解了。单独的容器有自己的生命周期（创建，运行，更新，删除）。一个容器你还好管理，但是如果100个，甚至1000个或者上万个容器呢？你不可能一台一台管理，这时候就需要有这个一个平台来自动帮你监控管理这一个个容器了，类似K8s这样的平台软件就孕育而生了。</br>

关于K8s，就介绍这么多，之前我们有专门介绍的K8s班会，想要复习的小伙伴可以回去之前的班会视频看看。那Azure下的K8s和原生的K8s之间有什么区别呢？它的区别有以下几点：
1. 和AAD集成。原生的K8s没有用户管理的机制，你必须借助其他的用户管理软件来帮忙管理用户。AKS可以直接集成AAD，然后结合Kubernetes RBAC，来对不同的AAD user或group来授予相应的访问权限。
2. 和Logging/Monitoring系统集成。AKS上可以直接使用Azure Container Insights (Azure Monitor)来监控AKS上的Container的状况。原生的K8s需要自己部署日志或监控应用，比如EKL或Prometheus等。
3. AKS里的Master nodes不需要用户管理，也不收费。K8s里有两种node,一种是Master node或者说Control Plane，这个node上部署了K8s所有大脑成员，包括管理API的API server, 管理容器调度的Scheduler,管理容器生命周期的Controller，和K8s记忆大脑数据库Etcd。原生的K8s需要自己去部署这些大脑组件，而AKS直接帮你代劳了，连最痛苦的升级环节，都提供一件升级的功能。原来可能需要三四个小时来升级，现在半小时就差不多搞定了。这个是我个人觉得比起自己安装K8s，使用AKS部署最大的优势，省去太多事情了！
4. 自动扩展Node。在AKS,你可以设置自动扩展Node,但单台Node的使用率（CPU/Memory)超过你设定的限值时，它会在后台自动给你加一个node，省去了你手工运维时间。
5. 支持GPU node。如果你们的K8s是用来做大计算量的工作，比如大模型计算，那么Azure可以凭借它本身的优势， 给你提供支撑的起这种算力的电脑。
6. 支持更灵活的网络设置。因为AKS的背后原理是部署在Azure VM和Network上， 所以AKS可以利用Azure Network已有的优势，比如快速申请一个公共IP,方便用户互联网访问；或者把AKS所创建的网络和其他网络进行Pair，这样这两个网络的服务就可以不通过公网而相互访问。
7. Azure自带的镜像仓库。AKS可以直接使用Azure自带的镜像仓库ACR(Azure Container Registry)来存储镜像。
8. 还有其他Azure自带的服务，比如安全（网络安全，RBAC，容器隔离），DevOps CI/CD, 地区规范，大数据，等等。

总之，类似AKS这样由各家云产商包装后的K8s服务大大的减轻了运维同学的工作负担。这么好的服务，大家一定要熟悉起来！之后我们的Azure+Terraform实验会对更细的AKS进行讲解。实验班会见！