# 组团学Python第28期-文件读写操作

同学们好！欢迎大家参加我们的第28期班会，一起来系统的学习Python。

本期学习内容： 文件读写操作

在日常工作中，我们经常会有这样一个需求，就是需要从文本中读取信息，然后执行相应的操作。比如，你想出个英语考研单词红宝书，需要统计一下历年考题最高频的词汇，你不可能一个字一个字的去统计吧，这这时候就可以用程序去分析文件。分析的第一步就是读取文件，那今天我们就来看看Python是如何读取文件的吧。

在Python中，你可以使用open()函数来打开文件。open()函数接受文件路径和打开模式作为参数，并返回一个文件对象，你可以对这个对象进行读取、写入等操作。以下是open()函数的基本用法：

file = open("filename.txt", mode="r", encoding=None, error=None)  # 打开名为"filename.txt"的文件，使用只读模式

open()函数的第一个参数是文件路径，可以是相对路径或绝对路径。

第二个参数是打开模式，指定文件的打开方式。这里的参数是关键字参数，使用了形参mode来特指打开方式。（忘了是什么是形参的同学可以去往期班会看一下）

常见的打开模式包括：

"r"：只读模式（默认）。文件必须存在，否则会引发异常。

"w"：写入模式。如果文件不存在，则创建新文件；如果文件已存在，则清空文件内容。

"a"：追加模式。如果文件不存在，则创建新文件；如果文件已存在，则在文件末尾添加内容。

"b"：二进制模式。用于处理二进制文件，如图片、视频等。可以与其他模式结合使用，如"rb"、"wb"等。

"t"：文本模式（默认）。用于处理文本文件。可以省略，因为文本模式是默认模式。

除了这些基本模式外，还可以使用组合模式，如"r+"（读写模式）、"w+"（读写模式，文件不存在时创建新文件）、"a+"（读写模式，追加到文件末尾）等。

第三个参数encoding，指定文件的编码格式。例如，encoding="utf-8"表示使用UTF-8编码读取文件，默认为None，表示使用系统默认编码。

第四个参数errors，指定遇到编码错误时的处理方式。常见的处理方式包括"strict"（默认，遇到错误引发异常）、"ignore"（忽略错误）、"replace"（用特殊字符代替错误字符）等。默认为None，即使用系统默认的错误处理策略。在大多数情况下，这意味着遇到错误时会抛出异常，例如在文件编码不匹配或者无法解码的情况下。

打开文件后，可以使用文件对象的方法进行读取、写入等操作。比如:

file = open("example.txt", "r")

# 读取文件内容并打印到控制台
content = file.read()
print(content)

在这个例子中，我们使用 open() 函数打开了一个名为 example.txt 的文件，并指定了打开模式为读取模式（'r'）。然后，我们使用 file.read() 方法读取了文件的内容，并将其存储在变量 content 中。

操作完成后，我们还应该使用close()方法关闭文件，以释放系统资源。比如:

file.close()  # 关闭文件

不过为了确保文件在处理过程中始终能够被关闭，我们更推荐使用with语句来打开文件，这样可以在代码块执行完毕后自动关闭文件，即使发生异常也会执行关闭操作。比如:

with open("filename.txt", "r") as file:
    # 在这里进行文件操作
    data = file.read()
    print(data)
# 文件在此处自动关闭

这里我们简单介绍一下with。with 是 Python 中用于管理上下文的语句，它提供了一种更加优雅、更安全的方式来管理资源，除了文件，它还能管理像网络连接、数据库连接这样的资源。with 语句的一般形式是:

with expression as variable:
    # 在此处使用 variable 执行一些操作

expression 是一个上下文管理器对象，它可以是一个支持上下文管理协议的对象，例如文件对象、数据库连接对象等。variable 是一个变量名，用来引用上下文管理器的结果。

with 语句的执行流程是这样的：expression 返回一个上下文管理器对象，并调用该对象的 __enter__() 方法。通常，在 __enter__() 方法中会进行资源的初始化或分配，并返回一个表示资源的对象。当 with 语句块执行完毕时，无论是否发生异常，都会调用上下文管理器对象的 __exit__() 方法来进行资源的释放和清理。在 __exit__() 方法中通常会进行资源的关闭、释放或异常处理等操作。

以上这些方法，如果看不懂，没关系，这是类class里的知识点，提前剧透一下，以后班会会讲。

使用 with 语句有以下几个优点：

1.自动关闭资源： 使用 with 语句可以确保在退出 with 语句块时自动关闭资源，无需手动调用关闭方法。

2.异常安全： with 语句能够处理可能发生的异常，确保在异常发生时也能正确关闭资源，避免资源泄露。

3.代码简洁： 使用 with 语句可以使代码更加简洁、清晰，提高可读性和可维护性。with 语句最常用于处理文件读写、数据库操作、网络连接等需要手动管理资源的场景，但它也可以用于其他任何需要管理上下文的情况。

所以能用with就用with吧。

以上就是今天的班会全部内容，我们下期班会再见！

今日练习:

When opening a file using the open() function in Python, what mode is used to open the file for both reading and writing?

